<!--
index: 8
title: 个性化 tooltip
resource:
  jsFiles:
    - ${url.jquery}
-->

<script>
 const data = [
    { date: "2017-06-05", value: 116 },
    { date: "2017-06-06", value: 129 },
    { date: "2017-06-07", value: 135 },
    { date: "2017-06-08", value: 86 },
    { date: "2017-06-09", value: 73 },
    { date: "2017-06-10", value: 85 },
    { date: "2017-06-11", value: 73 },
    { date: "2017-06-12", value: 68 },
    { date: "2017-06-13", value: 92 },
    { date: "2017-06-14", value: 130 },
    { date: "2017-06-15", value: 245 },
    { date: "2017-06-16", value: 139 },
    { date: "2017-06-17", value: 115 },
    { date: "2017-06-18", value: 111 },
    { date: "2017-06-19", value: 309 },
    { date: "2017-06-20", value: 206 },
    { date: "2017-06-21", value: 137 },
    { date: "2017-06-22", value: 128 },
    { date: "2017-06-23", value: 85 },
    { date: "2017-06-24", value: 94 },
    { date: "2017-06-25", value: 71 },
    { date: "2017-06-26", value: 106 },
    { date: "2017-06-27", value: 84 },
    { date: "2017-06-28", value: 93 },
    { date: "2017-06-29", value: 85 },
    { date: "2017-06-30", value: 73 }
  ];
  const chart = new F2.Chart({
    id: 'mountNode',
    width: window.innerWidth,
    height: window.innerWidth * 0.707,
    pixelRatio: window.devicePixelRatio,
    padding: [ 0, 'auto', 'auto' ]
  });

  chart.source(data, {
    value: {
      tickCount: 5,
      min: 0
    },
    date: {
      type: 'timeCat',
      range: [ 0, 1 ],
      tickCount: 3
    }
  });

  chart.axis('date', {
    label(text, index, total) {
      const textCfg = {};
      if (index === 0) {
        textCfg.textAlign = 'left';
      }
      if (index === total - 1) {
        textCfg.textAlign = 'right';
      }
      return textCfg;
    }
  });
  chart.axis('value', {
    label(text, index, total) {
      const textCfg = {};
      if (index === 0) {
        textCfg.textBaseline = 'bottom';
      }
      if (index === total - 1) {
        textCfg.textBaseline = 'top';
      }
      return textCfg;
    }
  });
  chart.guide().html({
    position: [ 'min', 'max' ],
    html: `
      <div id="tooltipWrapper" style="height: 30px;background-color:#BAE7FF;line-height: 30px;">
        <div id="tooltipName" style="float:left;fontSize:12px;color:#000;"></div>
        <div id="tooltipValue" style="float:right;fontSize:12px;color:#000;"></div>
      </div>
      `,
    offsetY: -15
  });
  chart.tooltip({
    custom(obj) {
      const { items } = obj;
      const { date, value } = items[0].origin;
      $('#tooltipWrapper').width($('#mountNode').width());
      $('#tooltipWrapper').css('left', 0);
      $('#tooltipName').css('margin-left', 15);
      $('#tooltipValue').css('margin-right', 15);

      $('#tooltipName').text(date);
      $('#tooltipValue').text(value);
      $('#tooltipWrapper').show();
    },
    onHide() {
       $('#tooltipWrapper').hide();
    }
  });
  chart.line()
    .position('date*value')
    .animate({
      appear: {
        duration: 1200
      }
    });
  chart.render();

  // 图表加载后默认展示某一点的 tooltip
  const point = chart.getPosition({ date: "2017-06-15", value: 245 });
  chart.showTooltip(point);
</script>
